# Node.js Docker 사용법

나중에 도커를 사용하여 그동안 만든 nodejs 프로젝트를 다른 서버에 옮기려고 할 때 도커 사용법이 기억이 나지 않는 상황에서 간단히 사용하기 위해 작성한다.

> 더 많은 사용법은 인터넷에서 찾아보기를 바람

## 프로젝트 Docker 컨테이너 생성 및 실행

### 1. Dockerfile를 만든 후 작성한다.

프로젝트가 완성된 후 프로젝트 폴더 안에 Dockerfile(확장자 X) 파일을 만든다.

### 2. 이미지를 빌드한다.

Build 명령어 예시

```
docker build . -t docker-sample:1.0
```

이 명령어에서 `.`은 Dockerfile가 위치한 폴더를 나타낸 것이다. `-t` 뒤에 `docker-sample`은 이미지명을 의미하고 `1.0`은 이미지의 버전을 의미한다.

### 3. 만든 이미지 실행

실행 명령어 예시

```
docker run -d -p 8080:8080 docker-sample:1.0
```

이 명령어에서 `-d`는 detach 모드를 의미한다. detach 모드를 사용하게 되면 백그라운드에서 서버가 실행된다. `-p`는 포트를 의미한다. `-p` 뒤에 `8080:8080`는 외부에서 접속할 포트 번호와 도커에서 사용될 포트 번호로 구성되어 있다. `docker-sample:1.0`는 레포지토리 이름 말고도 해당 이미지의 ID가 와도 작동된다.

### 관련 명령어들

> **참고사항**  
> 컨테이너 ID는 `docker ps` 명령어를 통해 확인 가능  
> 리포지토리 명과 이미지 ID는 `docker images` 명령어를 통해 확인 가능

- `docker images`: 도커의 이미지 목록을 보여준다.
- `docker ps`: 현재 실행 중인 컨테이터 목록을 보여준다.
- `docker stop [컨테이너 ID]`: 실행 중인 컨테이너 종료
- `docker rm [컨테이너 ID]`: 컨테이너 제거 명령어
- `docker rmi [리포지토리명 & 이미지ID]`: 이미지 제거 명령어
- `docker logs (-f) [컨테이너 ID]`: 실행 중인 컨테이너의 현재까지 로그들 확인. **(`-f`는 앞으로의 출력하는 로그 모니터링 기능, `ctrl + c`로 종료)**

## Docker Hub에 이미지 업로드 및 다운로드

다른 서버에서도 이 프로젝트를 사용할려면 Docker Hub에 프로젝트를 올려 다른 서버에서 내려받아 사용해야 한다.  
**Docker Hub를 사용할려면 Docker에서 만든 계정으로 로그인 하여야 한다.**

### 이미지 업로드

#### 이미지 태그 생성 명령어 예제

```
docker tag docker-sample:1.0 lambda0703/docker-sample:1.0
```

`docker-sample:1.0`은 현재 이미지명과 버전으로 이뤄져있다. `lambda0703/docker-sample:1.0`은 **현재 도커 계정명**과 이미지명, 버전으로 이루어져있다.

#### 이미지 업로드 명령어 얘재

```
docker push lambda0703/docker-sample:1.0
```

`push` 뒤에 `tag` 명령어로 바뀐 이름을 작성해준다.

### 이미지 다운로드

#### 이미지 다운로드 명령어 예제

```
docker pull lambda0703/docker-sample:1.0
```

해당 서버에서 이 명령어를 실행하면 업로드 된 이미지가 생성이 된다. 생성이 된 이미지를 실행만 하면 환경이 모두 세팅된 node.js 서버가 정상 작동 된다.
